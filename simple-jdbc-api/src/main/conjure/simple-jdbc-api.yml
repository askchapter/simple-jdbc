types:
  definitions:
    default-package: org.simplejdbc.api
    objects:
      TableLocator:
        fields:
          catalog: string
          schema: string
          table: string

      Table:
        fields:
          locator: TableLocator
          type: string

      ColumnType:
        values:
          - STRING
          - INTEGER
          - DOUBLE
          - BOOLEAN

      Column:
        fields:
          name: string
          type: ColumnType

      Statement:
        fields:
          sql: string

      ParameterValue:
        union:
          string: string
          integer: integer

      PreparedStatement:
        fields:
          sql: string
          parameterValues: list<ParameterValue>

      Query:
        union:
          statement: Statement
          preparedStatement: PreparedStatement
          table: TableLocator

      CatalogsRequest:
        fields:
          jdbcUrl: string

      TablesRequest:
        fields:
          jdbcUrl: string
          catalog: optional<string>

      PreviewRequest:
        fields:
          jdbcUrl: string
          query: Query
          limit: optional<integer>

      PreviewResponse:
        fields:
          columns: list<Column>
          rows: list<list<any>>
          totalRows: optional<integer>

      CsvDelimiter:
        values:
          - COMMA
          - PIPE
          - TAB

      CsvDownloadOptions:
        fields:
          includeHeader: boolean
          separator: CsvDelimiter

      DownloadOptions:
        union:
          csv: CsvDownloadOptions

      DownloadRequest:
        fields:
          jdbcUrl: string
          query: Query
          downloadOptions: DownloadOptions

      JdbcDriver:
        fields:
          path: string
          className: string

      Configuration:
        fields:
          drivers: list<JdbcDriver>

services:
  SimpleJdbcService:
    name: Simple JDBC
    package: org.simplejdbc.api
    base-path: /
    endpoints:
      catalogs:
        http: POST /catalogs
        args:
          catalogsRequest: CatalogsRequest
        returns: list<string>

      tables:
        http: POST /tables
        args:
          tablesRequest: TablesRequest
        returns: list<Table>

      preview:
        http: POST /preview
        args:
          previewRequest: PreviewRequest
        returns: PreviewResponse

      download:
        http: POST /download
        args:
          downloadRequest: DownloadRequest
        returns: binary

      # update